<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}DoD Budget Explorer{% endblock %}</title>

  <!-- DONE [Group: LION] LION-010: Dark mode toggle with CSS custom properties -->
  <script>
    // LION-010: Apply saved theme before first paint to avoid flash
    (function() {
      var saved = localStorage.getItem('dod_theme');
      if (saved) {
        document.documentElement.setAttribute('data-theme', saved);
      }
    })();
  </script>

  <!-- FE-009: Meta description and Open Graph tags -->
  <meta name="description" content="Search and explore U.S. Department of Defense budget justification data across fiscal years, services, and appropriation accounts.">
  <meta property="og:title" content="DoD Budget Explorer">
  <meta property="og:description" content="Search and explore U.S. Department of Defense budget justification data across fiscal years, services, and appropriation accounts.">
  <meta property="og:type" content="website">

  <!-- FE-008: CDN scripts with SRI integrity hashes -->
  <!-- HTMX for dynamic page updates without full reloads -->
  <link rel="preconnect" href="https://unpkg.com">
  <script src="https://unpkg.com/htmx.org@1.9.10"
          integrity="sha384-D1Kt99CQMDuVetoL1lrYwg5t+9QdHe7NLX/SoJYkXDFfX37iInKRy5ViYgSibmK"
          crossorigin="anonymous"></script>
  <!-- Chart.js for visualizations (3.B*) -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"
          integrity="sha384-adDgSZjMlMxVMhMoAHMqLODe/TiKMc9oF3vOoRWJA3lMXpQ1nOKr7Ld5Bh7G5Kf"
          crossorigin="anonymous"></script>
  <!-- chartjs-chart-treemap for hierarchical budget breakdowns -->
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-treemap@2.3.0/dist/chartjs-chart-treemap.min.js"
          crossorigin="anonymous"></script>

  <link rel="stylesheet" href="/static/css/main.css">
  {% block extra_head %}{% endblock %}
</head>
<body>

<!-- FE-004: Skip to main content link -->
<a href="#main-content" class="skip-link">Skip to main content</a>

<header class="site-header">
  <div class="container header-inner">
    <a class="site-title" href="/">DoD Budget Explorer</a>
    <nav class="site-nav" aria-label="Main navigation">
      <button class="hamburger" aria-label="Toggle navigation" aria-expanded="false">
        <span class="hamburger-bar"></span>
        <span class="hamburger-bar"></span>
        <span class="hamburger-bar"></span>
      </button>
      <div class="nav-links">
        <a href="/dashboard" {% if request.url.path == "/dashboard" %}class="active"{% endif %}>Dashboard</a>
        <a href="/"          {% if request.url.path == "/" %}class="active"{% endif %}>Search</a>
        <a href="/charts"    {% if request.url.path == "/charts" %}class="active"{% endif %}>Charts</a>
        <a href="/programs"  {% if request.url.path.startswith("/programs") %}class="active"{% endif %}>Programs</a>
        <a href="/about"     {% if request.url.path == "/about" %}class="active"{% endif %}>About</a>
        <a href="/docs"      target="_blank" rel="noopener">API Docs</a>
      </div>
      <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
        <span class="icon-moon">&#9790;</span>
        <span class="icon-sun">&#9788;</span>
      </button>
    </nav>
  </div>
</header>

<main id="main-content" class="container main-content" tabindex="-1">
  {% block content %}{% endblock %}
</main>

<footer class="site-footer">
  <div class="container">
    Data sourced from <a href="https://comptroller.defense.gov/Budget-Materials/" target="_blank"
      rel="noopener">DoD Comptroller</a>.
    This is an independent research tool; not affiliated with the U.S. Department of Defense.
    <a href="/docs" target="_blank" rel="noopener">API</a>
    <!-- DONE [Group: LION] LION-002: Feedback button -->
    <button class="btn btn-secondary btn-sm feedback-btn" onclick="openFeedbackModal()" aria-label="Send feedback">Feedback</button>
  </div>
</footer>

<!-- DONE [Group: LION] LION-002: Feedback form modal -->
{% include "partials/feedback.html" %}

<script src="/static/js/checkbox-select.js"></script>
{% block extra_scripts %}{% endblock %}
</body>
</html>
